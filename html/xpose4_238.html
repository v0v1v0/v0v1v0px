<div class="container">

<table style="width: 100%;"><tr>
<td>xpose.plot.default</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Xpose 4 generic functions for continuous y-variables.</h2>

<h3>Description</h3>

<p>This function is a wrapper for the lattice xyplot function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">xpose.plot.default(
  x,
  y,
  object,
  inclZeroWRES = FALSE,
  onlyfirst = FALSE,
  samp = NULL,
  panel = xpose.panel.default,
  groups = object@Prefs@Xvardef$id,
  ids = object@Prefs@Graph.prefs$ids,
  logy = FALSE,
  logx = FALSE,
  yscale.components = "default",
  xscale.components = "default",
  aspect = object@Prefs@Graph.prefs$aspect,
  funx = NULL,
  funy = NULL,
  iplot = NULL,
  PI = NULL,
  by = object@Prefs@Graph.prefs$condvar,
  force.by.factor = FALSE,
  ordby = object@Prefs@Graph.prefs$ordby,
  byordfun = object@Prefs@Graph.prefs$byordfun,
  shingnum = object@Prefs@Graph.prefs$shingnum,
  shingol = object@Prefs@Graph.prefs$shingol,
  by.interval = NULL,
  strip = function(...) {
     strip.default(..., strip.names = c(TRUE, TRUE))
 },
  use.xpose.factor.strip.names = TRUE,
  subset = xsubset(object),
  autocorr = FALSE,
  main = xpose.create.title(x, y, object, subset, funx, funy, ...),
  xlb = xpose.create.label(x, object, funx, logx, autocorr.x = autocorr, ...),
  ylb = xpose.create.label(y, object, funy, logy, autocorr.y = autocorr, ...),
  scales = list(),
  suline = object@Prefs@Graph.prefs$suline,
  bwhoriz = object@Prefs@Graph.prefs$bwhoriz,
  dilution = FALSE,
  dilfrac = object@Prefs@Graph.prefs$dilfrac,
  diltype = object@Prefs@Graph.prefs$diltype,
  dilci = object@Prefs@Graph.prefs$dilci,
  seed = NULL,
  mirror = FALSE,
  max.plots.per.page = 4,
  mirror.aspect = "fill",
  pass.plot.list = FALSE,
  x.cex = NULL,
  y.cex = NULL,
  main.cex = NULL,
  mirror.internal = list(strip.missing = missing(strip)),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A string or a vector of strings with the name(s) of the
x-variable(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A string or a vector of strings with the name(s) of the
y-variable(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An "xpose.data" object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inclZeroWRES</code></td>
<td>
<p>A logical value indicating whether rows with WRES=0
should be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>onlyfirst</code></td>
<td>
<p>A logical value indicating whether only the first row per
individual should be included in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samp</code></td>
<td>
<p>An integer between 1 and object@Nsim
(see<code>xpose.data-class</code>) specifying which of the simulated data
sets to extract from SData.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel</code></td>
<td>
<p>The name of the panel function to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>A string with the name of any grouping variable (used as the
groups argument to <code>panel.xyplot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ids</code></td>
<td>
<p>A logical value indicating whether text labels should be used as
plotting symbols (the variable used for these symbols indicated by the
<code>idlab</code> xpose data variable).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logy</code></td>
<td>
<p>Logical value indicating whether the y-axis should be
logarithmic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logx</code></td>
<td>
<p>Logical value indicating whether the x-axis should be
logarithmic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yscale.components</code></td>
<td>
<p>Used to change the way the axis look if <code>logy</code>
is used. Can be a user defined function or
<code>link{xpose.yscale.components.log10}</code>.  If the axes are not log
transformed then
<code>yscale.components.default</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xscale.components</code></td>
<td>
<p>Used to change the way the axis look if <code>logx</code>
is used. Can be a user defined function or
<code>link{xpose.xscale.components.log10}</code>.  If the axes are not log
transformed then
<code>xscale.components.default</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aspect</code></td>
<td>
<p>The aspect ratio of the display (see
<code>xyplot</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>funx</code></td>
<td>
<p>String with the name of a function to apply to the x-variable
before plotting, e.g. "abs".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>funy</code></td>
<td>
<p>String with the name of a function to apply to the y-variable
before plotting, e.g. "abs".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iplot</code></td>
<td>
<p>Is this an individual plots matrix? Internal use only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PI</code></td>
<td>
<p>Either "lines", "area" or "both" specifying whether prediction
intervals (as lines, as a shaded area or both) should be computed from the
data in <code>SData</code> and added to the display. <code>NULL</code> means no
prediction interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>A string or a vector of strings with the name(s) of the
conditioning variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force.by.factor</code></td>
<td>
<p>Logical value. If TRUE, and <code>by</code> is not
<code>NULL</code>, the variable specified by <code>by</code> is taken as categorical.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ordby</code></td>
<td>
<p>A string with the name of a variable to be used to reorder any
factor conditioning variables (<code>by</code>). The variable is used in a call to
the <code>reorder.factor</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>byordfun</code></td>
<td>
<p>The name of the function to be used when reordering a factor
conditioning variable (see argument <code>ordby</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shingnum</code></td>
<td>
<p>The number of shingles ("parts") a continuous conditioning
variable should be divided into.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shingol</code></td>
<td>
<p>The amount of overlap between adjacent shingles (see argument
<code>shingnum</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by.interval</code></td>
<td>
<p>The intervals to use for conditioning on a continuous
variable with <code>by</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strip</code></td>
<td>
<p>The name of the function to be used as the strip argument to
the <code>xyplot</code>. An easy way to change the strip
appearance is to use <code>strip.custom</code>.  For example, if
you want to change the text in the strips you can use
<code>strip=strip.custom(factor.levels=c("Hi","There"))</code> if the <code>by</code>
variable is a factor and <code>strip=strip.custom(var.name=c("New Name"))</code>
if the <code>by</code> variable is continuous.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.xpose.factor.strip.names</code></td>
<td>
<p>Use factor names in strips of
conditioning plots..</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>A string giving the subset expression to be applied to the
data before plotting. See <code>xsubset</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autocorr</code></td>
<td>
<p>Is this an autocorrelation plot?  Values can be
<code>TRUE/FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>A string giving the plot title or <code>NULL</code> if none.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlb</code></td>
<td>
<p>A string giving the label for the x-axis. <code>NULL</code> if none.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylb</code></td>
<td>
<p>A string giving the label for the y-axis. <code>NULL</code> if none.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scales</code></td>
<td>
<p>A list to be used for the <code>scales</code> argument in
<code>xyplot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suline</code></td>
<td>
<p>A string giving the variable to be used to construct a smooth
to superpose on the display. <code>NULL</code> if none. This argument is used if
you want to add a superpose line of a variable not present in the <code>y</code>
list of variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bwhoriz</code></td>
<td>
<p>A logical value indicating if box and whiskers bars should be
plotted horizontally or not. Used when the x-variable(s) is categorical.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dilution</code></td>
<td>
<p>Logical value indicating whether data dilution should be
used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dilfrac</code></td>
<td>
<p>Dilution fraction indicating the expected fraction of
individuals to display in the plots. The exact meaning depends on the type
of dilution (see below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diltype</code></td>
<td>
<p>Indicating what type of dilution to apply. <code>NULL</code> means
random dilution without stratification. A non<code>NULL</code> value means
stratified dilution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dilci</code></td>
<td>
<p>A number between 0 and 1 giving the range eligible for dilution
in a stratified dilution (see below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed number used for random dilution. <code>NULL</code> means no seed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mirror</code></td>
<td>
<p>Should we create mirror plots from simulation data?  Value can
be <code>FALSE</code>, <code>TRUE</code> or <code>1</code> for one mirror plot, or <code>3</code>
for three mirror plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.plots.per.page</code></td>
<td>
<p>The maximum number of plots per page that can be
created with the mirror plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mirror.aspect</code></td>
<td>
<p>The aspect ratio of the plots used for mirror
functionality.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pass.plot.list</code></td>
<td>
<p>Should we pass the list of plots created with mirror
or should we print them directly.  Values can be <code>TRUE/FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.cex</code></td>
<td>
<p>The size of the x-axis label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.cex</code></td>
<td>
<p>The size of the y-axis label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main.cex</code></td>
<td>
<p>The size of the title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mirror.internal</code></td>
<td>
<p>an internal mirror argument used in
<code>create.mirror</code>.  Checks if the <code>strip</code> argument from
<code>xyplot</code> has been used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments passed to <code>xpose.panel.default</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>y</code> must be numeric (continuous) while <code>x</code> can be either numeric
of factor. If <code>x</code> is numeric then a regular xy-plot is drawn. If x is a
factor, on the other hand, a box and whiskers plot is constructed.
</p>
<p><code>x</code> and <code>y</code> can be either single valued strings or vector of
strings. <code>x</code> and <code>y</code> can not both be vectors in the same call to
the function.
</p>
<p>If <code>ids</code> is <code>TRUE</code>, text labels are added to the plotting symbols.
The labels are taken from the <code>idlab</code> xpose data variable. The way the
text labels are plotted is governed by the <code>idsmode</code> argument (passed
down to the panel function). <code>idsmode=NULL</code> (the default) means that
only extreme data points are labelled while a non-<code>NULL</code> value adds
labels to all data points (the default in Xpose 3).
<code>xpose.panel.default</code> identifies extreme data points by fitting a loess
smooth (<code>y~x</code>) and looking at the residuals from that fit. Points that
are associated with the highest/lowest residuals are labelled. "High" and
"low" are judged by the panel function parameter <code>idsext</code>, which gives
the fraction of the total number of data points that are to be judged
extreme in the "up" and "down" direction. The default value for
<code>idsext</code> is 0.05 (see <code>xpose.prefs-class</code>). There is also a
possibility to label only the high or low extreme points. This is done
through the <code>idsdir</code> argument to <code>xpose.panel.default</code>. A value of
"both" (the default) means that both high and low extreme points are
labelled while "up" and "down" labels the high and low extreme points
respectively.
</p>
<p>Data dilution is useful is situations when there is an excessive amount of
data. <code>xpose.plot.default</code> can dilute data in two different ways. The
first is a completely random dilution in which all individuals are eligible
for exclusion from the plot. In this case the argument <code>dilfrac</code>
determines the fraction of individuals that are excluded from the plot. The
second type of dilution uses stratification to make sure that none of the
extreme individuals are omitted from the plot. Extreme individuals are
identified in a similar manner as extreme data points are identified for
text labelling. A smooth is fitted to the data and the extreme residuals
from that fit is used to inform about extremeness. What is judged as extreme
is determined by the argument <code>dilci</code>, which defaults to 0.95 (Note
that the meaning of this is the opposite to <code>idsext</code>). <code>dilci</code>
give the confidence level of the interval around the fitted curve outside of
which points are deemed to be extreme. Extreme individuals are those that
have at least one point in the "extremeness" interval. Individuals that do
not have any extreme points are eligible for dilution and <code>dilfrac</code>
give the number of these that should be omitted from the graph. This means
that <code>dilfrac</code> should usually be grater for stratified dilution than in
completely random dilution. Any smooths added to a diluted plot is based on
undiluted data.
</p>
<p>More graphical parameters may be passed to
<code>xpose.panel.default</code>.
</p>


<h3>Value</h3>

<p>Returns a xyplot graph object.
</p>


<h3>Author(s)</h3>

<p>E. Niclas Jonsson, Mats Karlsson, Andrew Hooker &amp; Justin Wilkins
</p>


<h3>See Also</h3>

<p><code>xpose.panel.default</code>, <code>xyplot</code>,
<code>panel.xyplot</code>, <code>xpose.prefs-class</code>,
<code>xpose.data-class</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
## xpdb5 is an Xpose data object
## We expect to find the required NONMEM run and table files for run
## 5 in the current working directory
xpdb5 &lt;- xpose.data(5)

## A spaghetti plot of DV vs TIME
xpose.plot.default("TIME", "DV", xpdb5) 

## A conditioning plot
xpose.plot.default("TIME", "DV", xpdb5, by = "SEX")
 
## Multiple x-variables
xpose.plot.default(c("WT", "SEX"), "CL", xpdb5)

## Multiple y-variables
xpose.plot.default("WT", c("CL", "V"), xpdb5)
xpose.plot.default("WT", c("CL", "V"), xpdb5, by=c("SEX", "HCTZ"))

## determining the interval for the conditioning variable
wt.ints &lt;- matrix(c(50,60,60,70,70,80,80,90,90,100,100,150),nrow=6,ncol=2,byrow=T)
xpose.plot.default("TIME","DV",xpdb5,by="WT", by.interval=wt.ints)

## End(Not run)


</code></pre>


</div>