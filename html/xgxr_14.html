<div class="container">

<table style="width: 100%;"><tr>
<td>predictdf.nls</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prediction data frame for nls</h2>

<h3>Description</h3>

<p>Get predictions with standard errors into data frame for use with geom_smooth
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'nls'
predictdf(model, xseq, se, level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>nls object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xseq</code></td>
<td>
<p>newdata</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>Display confidence interval around smooth?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Level of confidence interval to use</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>ggplot2::geom_smooth</code> produces confidence intervals by silently calling functions 
of the form predictdf.method, where method is "loess", "lm", "glm" etc. 
depending on what method is specified in the call to <code>geom_smooth</code>. 
Currently <code>ggplot2</code> does not define a <code>predictdf.nls</code> function for method of type "nls", 
and thus confidence intervals cannot be automatically generated by <code>geom_smooth</code> 
for method = "nls". Here we define <code>predictdf.nls</code> for calculating the confidence 
intervals of an object of type nls. <code>geom_smooth</code> will silently call this function 
whenever method = "nls", and produce the appropriate confidence intervals.
</p>
<p><code>predictdf.nls</code> calculates CI for a model fit of class nls based on the "delta-method" 
http://sia.webpopix.org/nonlinearRegression.html#confidence-intervals-and-prediction-intervals)
</p>
<p>CI = [ f(x0, beta) + qt_(alpha/2, n - d) * se(f(x0, beta)),
f(x0, beta) + qt_(1 - alpha/2, n - d) * se(f(x0, beta))]
</p>
<p>where:
beta = vector of parameter estimates
x = independent variable
se(f(x0, beta)) = sqrt( delta(f)(x0, beta) * Var(beta) * (delta(f)(x0, beta))' )
delta(f) is the gradient of f
</p>


<h3>Value</h3>

<p>dataframe with x and y values, if se is TRUE dataframe also includes ymin and ymax
</p>


</div>