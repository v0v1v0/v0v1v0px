<div class="container">

<table style="width: 100%;"><tr>
<td>booster2sql</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Transform XGBoost model object to SQL query.</h2>

<h3>Description</h3>

<p>This function generates SQL query for in-database scoring of XGBoost models,
providing a robust and efficient way of model deployment. It takes in the trained XGBoost model <code>xgbModel</code>,
name of the input database table <code>input_table_name</code>,
and name of a unique identifier within that table <code>unique_id</code> as input,
writes the SQL query to a file specified by <code>output_file_name</code>.
Note that the input database table should be generated from the raw table using the one-hot encoding query output by <code>onehot2sql()</code>,
or to provide the one-hot encoding query as input <code>input_onehot_query</code> to this function, working as sub-query inside the final model scoring query.
</p>


<h3>Usage</h3>

<pre><code class="language-R">booster2sql(xgbModel, print_progress = FALSE, unique_id = NULL,
  output_file_name = NULL, input_table_name = NULL,
  input_onehot_query = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xgbModel</code></td>
<td>
<p>The trained model object of class <code>xgb.Booster</code>.
Current supported booster is <code>booster="gbtree"</code>, supported <code>objective</code> options are:
</p>

<ul>
<li>
<p> – <code>reg:linear</code>: linear regression.
</p>
</li>
<li>
<p> – <code>reg:logistic</code>: logistic regression.
</p>
</li>
<li>
<p> - <code>binary:logistic</code>: logistic regression for binary classification, output probability.
</p>
</li>
<li>
<p> – <code>binary:logitraw</code>: logistic regression for binary classification, output score before logistic transformation.
</p>
</li>
<li>
<p> - <code>binary:hinge</code>: hinge loss for binary classification. This makes predictions of 0 or 1, rather than producing probabilities.
</p>
</li>
<li>
<p> - <code>count:poisson</code>: poisson regression for count data, output mean of poisson distribution.
</p>
</li>
<li>
<p> - <code>reg:gamma</code>: gamma regression with log-link, output mean of gamma distribution. It might be useful, e.g., for modeling insurance claims severity, or for any outcome that might be gamma-distributed.
</p>
</li>
<li>
<p> - <code>reg:tweedie</code>: Tweedie regression with log-link. It might be useful, e.g., for modeling total loss in insurance, or for any outcome that might be Tweedie-distributed.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print_progress</code></td>
<td>
<p>Boolean indicator controls whether the SQL generating progress should be printed to console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unique_id</code></td>
<td>
<p>A row unique identifier is crucial for in-database scoring of XGBoost model. If not given, SQL query will be generated with id name "ROW_KEY".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_file_name</code></td>
<td>
<p>File name that the SQL syntax will write to. It must not be empty in order for this function to run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input_table_name</code></td>
<td>
<p>Name of raw data table in the database, that the SQL query will select from. If not given, SQL query will be generated with table name "MODREADY_TABLE".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input_onehot_query</code></td>
<td>
<p>SQL query of one-hot encoding generated by <code>onehot2sql</code>. When <code>input_table_name</code> is empty while <code>input_onehot_query</code> is not, the final output query will include <code>input_onehot_query</code> as sub-query.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The SQL query will write to the file specified by <code>output_file_name</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(xgboost)
# load data
df = data.frame(ggplot2::diamonds)
head(df)

# data processing
out &lt;- onehot2sql(df)
x &lt;- out$model.matrix[,colnames(out$model.matrix)!='price']
y &lt;- out$model.matrix[,colnames(out$model.matrix)=='price']

# model training
bst &lt;- xgboost(data = x,
               label = y,
               max.depth = 3,
               eta = .3,
               nround = 5,
               nthread = 1,
               objective = 'reg:linear')

# generate model scoring SQL script with ROW_KEY and MODREADY_TABLE
booster2sql(bst, output_file_name='xgb.txt')
</code></pre>


</div>